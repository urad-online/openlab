!function(){tinymce.create("tinymce.plugins.Subscribe2Plugin",{init:function(a,b){var c=0,d='<p><img src="'+b+'/../include/spacer.gif" class="mceSubscribe2 mceItemNoResize" /></p>',e="mceSubscribe2",f="[subscribe2]",g=[],h=new RegExp(/(\[|<!--)subscribe2.*?(\]|-->)/g),i=function(a){return-1!==a.indexOf('class="mceSubscribe2')&&(a=g[c]),a};a.addCommand("mceSubscribe2",function(){a.execCommand("mceInsertContent",0,d)}),a.addButton("subscribe2",{title:"Insert Subscribe2 Token",image:b+"/../include/s2-button.png",cmd:e}),a.on("init",function(){a.dom.loadCSS(b+"/css/content.min.css"),a.theme.onResolveName&&a.theme.onResolveName.add(function(b,c){"IMG"===c.node.nodeName&&a.dom.hasClass(c.node,e)&&(c.name="subscribe2")})}),a.on("BeforeSetContent",function(a){g=a.content.match(h),a.content=a.content.replace(h,d)}),a.on("PostProcess",function(a){if(a.get){if(null!==g)for(c=0;c<g.length;c++)a.content=a.content.replace(/<img[^>]+>/,i);a.content=a.content.replace(/<img[^>]+>/g,function(a){return-1!==a.indexOf('class="mceSubscribe2')&&(a=f),a})}})},getInfo:function(){return{longname:"Insert Subscribe2 Token",author:"Matthew Robinson",authorurl:"http://subscribe2.wordpress.com",infourl:"http://subscribe2.wordpress.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add("subscribe2",tinymce.plugins.Subscribe2Plugin)}();